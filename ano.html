<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Menu</title>
    <link rel="stylesheet" type="text/css" href="styles.css"/>
    <script type="module" src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.esm.js"></script>
</head>
<body>
    <div class="underlay-balck"></div>
    <div class="container">
        <header>
            <h1>Admin Dashboard</h1>
            <h2> Welcome back Admin!</h2>
        </header>
        <div class="navigation">
            <ul>
                <li class="list">
                    <a href="#" onclick="showDashboard()">
                        <span class="icon">
                            <ion-icon name="desktop-outline"></ion-icon>
                        </span>
                        <span class="title"> Dashboard</span>
                        <span class="tooltip"> Dashboard</span>
                    </a>
                </li>
                <li class="list"> 
                    <a href="#" onclick="showSearch()">
                        <span class="icon">
                            <ion-icon name="search"></ion-icon>
                        </span>
                        <span class="title"> Search</span>
                        <span class="tooltip"> Search</span>
                    </a>
                </li>
                <li class="list">
                    <a href="#" onclick="showRegistrationForm()">
                        <span class="icon">
                            <ion-icon name="add-circle"></ion-icon>
                        </span>
                        <span class="title"> Register Professional</span>
                        <span class="tooltip"> Register Professional</span>
                    </a>
                </li>
                <li class="list">
                    <a href="#" onclick="showProfessionalRegistration()">
                        <span class="icon">
                            <ion-icon name="person-add"></ion-icon>
                        </span>
                        <span class="title"> Register Admin</span>
                        <span class="tooltip"> Register Admin</span>
                    </a>
                </li>
                <li class="list">
                    <a href="logadmin.html" id="logoutButton">
                        <span class="icon">
                            <ion-icon name="log-out-outline"></ion-icon>
                        </span>
                        <span class="title">Log Out</span>
                        <span class="tooltip"> Log Out</span>
                    </a>
                </li>
            </ul>
            <div class="toggle"></div>
        </div>

        <div class="containerr">
            <section id="professionalList" style="display: none;">
                <h2>Registered Professionals</h2>
                <table>
                    <thead>
                        <tr>
                            <th>Logo</th>
                            <th>Name</th>
                            <th>Sector</th>
                            <th>Business Activity</th>
                            <th>Address</th>
                            <th>Phone number</th>
                            <th>Email</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="professionalTableBody">
                        <!-- Professionals will be dynamically populated here -->
                    </tbody>
                </table>
            </section>

            <section id="searchSection" style="display: none;">
                <h2 Search professionals></h2>
                <input type="text" id="searchInput" placeholder="Search by name or address..." oninput="-searchProfessionals()">            </section>
                     <table>
                        <thead>
                            <tr>
                            <th>Logo</th>
                            <th>Name</th>
                            <th>Sector</th>
                            <th>Business Activity</th>
                            <th>Address</th>
                            <th>Phone number</th>
                            <th>Email</th>
                            <th>Actions</th>

                            </tr>
                        </thead>
                        <tbody id="searchTableBody">

                        </tbody>
                     </table>
                     </section>
            <div id="professionalModal" style="display: none;">
                <h2>Add professional</h2>
                <form id="professionalForm">
                    <label for="logo">Logo URL:</label>
                    <input type="text" id="logo" required>

                    <label for="name">Name:</label>
                    <input type="text" id="name" required>

                    <label for="sector">Sector:</label>
                    <select id="sector" required>
                        <option value="">Select Sector</option>
                        <option value="Restaurant">Restaurant</option>
                        <option value="Hotel">Hotel</option>
                        <option value="Commerce">Commerce</option>
                        <option value="Tourism">Tourism</option>
                        <option value="Cabaret">Cabaret</option>
                        <option value="Banks">Banks</option>
                        <option value="Supermarket">Supermarket</option>
                        <option value="Health">Health</option>
                        <option value="Market">Market</option>
                    </select>
                    <label for="Region">Region</label>
                    <select id="Region" required >
                        <option value="">Select Region</option>
                        <option value="Littoral">Littoral</option>
                        <option value="Center">Center</option>
                        <option value="South-West">South-West</option>
                        <option value="West">West</option>
                        <option value="North-west">North-west</option>
                        <option value="Adamawa">Adamawa</option>
                        <option value="East">East</option>
                        <option value="South">South</option>
                        <option value="Far-North">Far-North</option>
                    </select>
                    <label for="Department">Department</label>
                    <select id="Department" required onchange="updateDepartments()">
                        <option value="">Select Department</option>
                    </select>

                    <label for="District"> District</label>
                    <select id="District" required onchange="updateDistricts()">
                        <option value="">Select District</option>
                    </select>

                    <label for="neighborhood"> neighborhood</label>
                    <select id="neighborhood" required onchange="updateNeighborhoods">
                        <option value="">Select neighborhood</option>
                    </select>

                    <label for="SpecificLocation"> Specific location</label>
                    <select id="SpecificLocation" required>
                        <option value="">Select District</option>
                    </select>

                    <label for="businessActivity">Business Activity:</label>
                    <textarea id="businessActivity" required></textarea>

                    <label for="address">Address:</label>
                    <input type="text" id="address" required>

                    <label for="phone">Phone Number:</label>
                    <input type="tel" id="phone" required>

                    <label for="email">Email Address:</label>
                    <input type="email" id="email" required>

                    <button type="submit" id="submitProfessionalBtn">Add Professional</button>
                </form>
            </div>
        </div>
    </div>

    <script type="text/javascript">

        document.addEventListener("DOMContentLoaded", function(){
        if(localStorage.getItem('isLoggedIn') !== 'true'){
            window.location.href = 'logadmin.html';
        }
        showDashboard();
        });
       document.getElementById('logoutButton').onclick = function(event){
        event.preventDefault();
        localStorage.removeItem('isLoggedIn');
        window.location.href = 'logadmin.html';
    }
let navigation = document.querySelector('.navigation');
let toggle = document.querySelector('.toggle');
let professionals = []; 
let currentEditIndex = -1; 


toggle.onclick = function() {
    navigation.classList.toggle('active');
}
document.getElementById('logoutBUtton').onclick = function(event){
            event.preventDefault();
            window.location.href = 'logadmin.html';
        }; 
function setActiveSection(section) {
   
    document.querySelectorAll('.navigation ul li').forEach(item => {
        item.classList.remove('active');
    });
    section.classList.add('active');
}

function showRegistrationForm() {
    clearForm();
    document.getElementById('professionalModal').style.display = 'block';
    document.getElementById('professionalList').style.display = 'none';
    setActiveSection(document.querySelector('.navigation ul li:nth-child(3)')); // Set active for "Register Professional"
}

function showDashboard() {
    document.getElementById('professionalModal').style.display = 'none';
    document.getElementById('professionalList').style.display = 'block';
    displayProfessionals(); // Refresh the list when showing the dashboard
    setActiveSection(document.querySelector('.navigation ul li:first-child')); // Set active for "Dashboard"
}

function showSearch(){
    document.getElementsById('professionalModal').style.display = 'none';
    document.getElementsById('professionalList').style.display = 'none';
    document.getElementsById('searchSection').style.display = 'block';
    setActiveSection(document.querySelector('.navigation ul li:nth-child(2)'));
}

document.querySelectorAll('.list a').forEach((link, index) => {
    link.addEventListener('click', function(event) {
        event.preventDefault(); //prevemts default anchor behavior
        if (index === 0) { 
            showDashboard();
        } else if (index === 1) { 
            showSearch();
        }else if(index == 2){
            showRegistrationForm();
        }
      
    });
});

document.getElementById('professionalForm').onsubmit = function(event) {
    event.preventDefault(); 

    // Get form values
    const logo = document.getElementById('logo').value;
    const name = document.getElementById('name').value;
    const sector = document.getElementById('sector').value;
    const businessActivity = document.getElementById('businessActivity').value;
    const phone = document.getElementById('phone').value;
    const email = document.getElementById('email').value;
    const Region = document.getElementById('Region').value;
    const Department= document.getElementById('Department').value;
    const District = document.getElementById('District').value;
    const neighborhood = document.getElementById('neighborhood').value;
    const address = `${Region}, ${Department}, ${District}, ${neighborhood}`;

    if (currentEditIndex > -1) {
        professionals[currentEditIndex] = {
            logo,
            name,
            sector,
            businessActivity,
            phone,
            email,
            address,
        };
        currentEditIndex = -1; 
    } else {
        professionals.push({
            logo,
            name,
            sector,
            businessActivity,
            phone,
            email,
            address,
        });
    }

    clearForm();
    document.getElementById('professionalModal').style.display = 'none'; 
    displayProfessionals(); 
}

function clearForm() {
    document.getElementById('logo').value = '';
    document.getElementById('name').value = '';
    document.getElementById('sector').value = '';
    document.getElementById('businessActivity').value = '';
    document.getElementById('phone').value = '';
    document.getElementById('email').value = '';
    document.getElementById('Region').value = '';
    document.getElementById('Department').value = '';
    document.getElementById('District').value = '';       
    document.getElementById('neighborhood').value = '';
}

function searchProfessionals(){

    const searchInput = document.getElementById('searchInput').value.toLowercase();
    const searchResults = professionals.filter(prof => prof.name.toLowercase().includes(searchInput)|| prof.address.toLowercase().includes(searchInput));
    displaySearchResults(searchResults);
}

function displaySearchResults(){
    const searchTableBody = document.getElementById('searchTableBody');
    searchTableBody.innerHTML = '';
    result.forEach((prof, index)=>{
        const newRow = searchTableBody.insertRow();
                newRow.innerHTML = `
                    <td><img src="${prof.logo}" alt="Logo" width="50"></td>
                    <td>${prof.name}</td>
                    <td>${prof.sector}</td>
                    <td>${prof.businessActivity}</td>
                    <td>${prof.address}</td>
                    <td>${prof.phone}</td>
                    <td>${prof.email}</td>
                    <td>
                        <button onclick="editProfessional(${index})">Edit</button>
                        <button onclick="deleteProfessional(${index})">Delete</button>
                    </td>
                `;
            }
    )
}

function closeModal() {
    document.getElementById('professionalModal').style.display = 'none';
    clearForm();
}

function updateDepartments(){
    const Region = document.getElementById('Region').value;
    const Department = document.getElementById('Department');
    Department.innerHTML = '<option value = >Select Department</option>';

    const departments = {
                'Littoral': ['Department1', 'Department2'],
                'Center': ['Department3', 'Department4'],
                'South-West': ['Department5', 'Department6'],
                'West': ['Department7', 'Department8'],
                'North-west': ['Department9', 'Department10'],
                'Adamawa': ['Department11', 'Department12'],
                'East': ['Department13', 'Department14'],
                'South': ['Department15', 'Department16'],
                'Far-North': ['Department17', 'Department18'],
};
if (neighborhoods[district]) {
                neighborhoods[district].forEach(neighborhood => {
                    neighborhoodSelect.innerHTML += `<option value="${neighborhood}">${neighborhood}</option>`;
                });
            }
        }

        function updateDistricts() {
            const department = document.getElementById('Department').value;
            const districtSelect = document.getElementById('District');
            districtSelect.innerHTML = '<option value="">Select District</option>'; // Reset options

            const districts = {
                'Department1': ['District1', 'District2'],
                'Department3': ['District3', 'District4'],
                'Department5': ['District5', 'District6'],
                'Department7': ['District7', 'District8'],
                'Department9': ['District9', 'District10'],
                'Department11': ['District11', 'District12'],
                'Department13': ['District13', 'District14'],
                'Department15': ['District15', 'District16'],
                'Department17': ['District17', 'District18'],
            };

            if (districts[department]) {
                districts[department].forEach(district => {
                    districtSelect.innerHTML += `<option value="${district}">${district}</option>`;
                });
            }
        }

        function updateNeighborhoods() {
            const district = document.getElementById('District').value;
            const neighborhoodSelect = document.getElementById('neighborhood');
            neighborhoodSelect.innerHTML = '<option value="">Select Neighborhood</option>'; // Reset options

            const neighborhoods = {
                'District1': ['Neighborhood1', 'Neighborhood2'],
                'District3': ['Neighborhood3', 'Neighborhood4'],
                'District5': ['Neighborhood5', 'Neighborhood6'],
                'District7': ['Neighborhood7', 'Neighborhood8'],
                'District9': ['Neighborhood9', 'Neighborhood10'],
                'District11': ['Neighborhood11', 'Neighborhood12'],
                'District13': ['Neighborhood13', 'Neighborhood14'],
                'District15': ['Neighborhood15', 'Neighborhood16'],
                'District17': ['Neighborhood17', 'Neighborhood18'],
            };

            if (neighborhoods[district]) {
                neighborhoods[district].forEach(neighborhood => {
                    neighborhoodSelect.innerHTML += `<option value="${neighborhood}">${neighborhood}</option>`;
                });
            }
        }


function deleteProfessional(index) {
    if (confirm('Are you sure you want to delete this professional?')) {
        professionals.splice(index, 1);
        displayProfessionals();
    }
}

function editProfessional(index) {
    const prof = professionals[index];
    document.getElementById('logo').value = prof.logo;
    document.getElementById('name').value = prof.name;
    document.getElementById('sector').value = prof.sector;
    document.getElementById('businessActivity').value = prof.businessActivity;
    document.getElementById('address').value = prof.address;
    document.getElementById('phone').value = prof.phone;
    document.getElementById('email').value = prof.email;
    const addressParts = prof.address.split(', ');
        document.getElementById('Region').value = addressParts[0];
        updateDepartments();
        document.getElementById('Department').value = addressParts[1];
        updateDistricts();
        document.getElementById('District').value = addressParts[2];
        updateNeighborhoods();
        document.getElementById('neighborhood').value = addressParts[3];


    currentEditIndex = index; // Set the index for editing
    document.getElementById('professionalModal').style.display = 'block'; // Show modal for editing
}

function displayProfessionals() {
    const tableBody = document.getElementById('professionalTableBody');
    tableBody.innerHTML = ''; // Clear the table body

    professionals.forEach((prof, index) => {
        const newRow = tableBody.insertRow();
        newRow.innerHTML = `
            <td><img src="${prof.logo}" alt="Logo" width="50"></td>
            <td>${prof.name}</td>
            <td>${prof.sector}</td>
            <td>${prof.businessActivity}</td>
            <td>${prof.address}</td>
            <td>${prof.phone}</td>
            <td>${prof.email}</td>
            <td>
                <button onclick="editProfessional(${index})">Edit</button>
                <button onclick="deleteProfessional(${index})">Delete</button>
            </td>
        `;
    });
 }
</script>
</body>
</html>